angular.module('app.controllers',[])
.controller('MainController', function($scope, account){
    $scope.loggedIn = false;
    $scope.$watch(function() {
        return account.getLogged();
    }, function(newValue, oldValue) {
       $scope.loggedIn = newValue;
    });
    
    $scope.emails = [
        {from:"Luffy", subject:"Gomu Gomu no Mi", date:"Straw Hat Pirates"},
        {from:"Sabo", subject:"Mera Mera no Mi", date:"Revolutionary Army"}
    ];
});
angular.module('app.services',[])
.factory("account",function(){
    var loggedIn = false;
    return {
        setLoggedIn: function (val) {
            loggedIn = val;
        },
        getLogged: function () {
            return loggedIn;
        }
    }
    
})
.factory("local",function() {
   return true; 
});
angular.module('app.directives',[])
.directive('eatClickIf', ['$parse', '$rootScope',
  function($parse, $rootScope) {
    return {
      // this ensure eatClickIf be compiled before ngClick
      priority: 100,
      restrict: 'A',
      compile: function($element, attr) {
        var fn = $parse(attr.eatClickIf);
        return {
          pre: function link(scope, element) {
            var eventName = 'click';
            element.on(eventName, function(event) {
              var callback = function() {
                if (fn(scope, {$event: event})) {
                  // prevents ng-click to be executed
                  event.stopImmediatePropagation();
                  // prevents href 
                  event.preventDefault();
                  return false;
                }
              };
              if ($rootScope.$$phase) {
                scope.$evalAsync(callback);
              } else {
                scope.$apply(callback);
              }
            });
          },
          post: function() {}
        }
      }
    }
  }
]);